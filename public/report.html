<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏° IT</title>
  <link rel="stylesheet" href="assets/css/report.css" />
</head>

<body>
  <div class="container">
    <h1>üõ†Ô∏è ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏° IT</h1>
    <p class="lead">
      ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏° IT ‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‚ú®
    </p>

    <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏ä‡πâ iframe ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á CORS -->
    <form id="ticketForm" method="POST" target="response-frame" enctype="multipart/form-data"
      action="https://script.google.com/macros/s/AKfycbyD5MVmkSpLNRMXTZy6WwsiVTZGJV5JXseXgqUJWYyLnMSGOny5CfQJJuVg-A6Bl-VqBQ/exec">

      <div class="grid">
        <div>
          <label>‡πÅ‡∏ú‡∏ô‡∏Å<span class="req">*</span></label>
          <select name="department" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å --</option>
            <option>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</option>
            <option>‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</option>
            <option>‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</option>
            <option>‡πÑ‡∏≠‡∏ó‡∏µ</option>
            <option>‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î</option>
            <option>‡∏à‡∏±‡∏î‡∏ã‡∏∑‡πâ‡∏≠</option>
            <option>‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</option>
            <option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
          </select>
        </div>

        <div>
          <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á<span class="req">*</span></label>
          <input type="text" name="requester" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ" />
        </div>

        <div>
          <label>‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠<span class="req">*</span></label>
          <input type="text" name="contact" required placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô, ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏µ‡πÄ‡∏°‡∏•" />
        </div>

        <div>
          <label>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå<span class="req">*</span></label>
          <select name="purpose" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå --</option>
            <option>‡πÄ‡∏û‡∏¥‡πà‡∏°</option>
            <option>‡∏¢‡πâ‡∏≤‡∏¢</option>
            <option>‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á</option>
            <option>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</option>
            <option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
          </select>
        </div>
      </div>

      <div class="grid grid-1">
        <div>
          <label>‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö ‡∏î‡πâ‡∏≤‡∏ô‡πÑ‡∏≠‡∏ó‡∏µ<span class="req">*</span></label>
          <select name="title" required>
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö --</option>
            <option>Printer (‡∏õ‡∏£‡∏¥‡πä‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå)</option>
            <option>Program (‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°)</option>
            <option>Computer (‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå)</option>
            <option>Internet / WIFI (‡∏≠‡∏¥‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ó)</option>
            <option>Telephone (‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå)</option>
            <option>CCTV</option>
            <option>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå IT ‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
          </select>
        </div>

        <div>
          <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏õ‡∏±‡∏ç‡∏´‡∏≤<span class="req">*</span></label>
          <textarea name="detail" required
            placeholder="‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏Å‡∏≤‡∏£, ‡πÄ‡∏Å‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏£, ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° error ‡∏≠‡∏∞‡πÑ‡∏£"></textarea>
        </div>

      <div>
        <label>‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
        <input type="file" name="file" accept="image/*" />
      </div>

      <div class="note">
        üí° ‡∏´‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Google Sheets ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏° LINE ‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡∏° IT ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
      </div>

      <div class="actions">
        <button type="submit" class="btn btn-primary">‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°</button>
        <button type="reset" class="btn btn-secondary">‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
      </div>

      <div id="status" class="status"></div>
    </form>

    <!-- iframe ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ö response -->
    <iframe id="response-frame" name="response-frame" style="display: none;"></iframe>

    <div class="footer">¬© 2024 IT Support</div>
  </div>

  <script>
    const form = document.getElementById("ticketForm");
    const statusEl = document.getElementById("status");
    const iframe = document.getElementById("response-frame");

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
    function showStatus(message, isSuccess = false) {
      statusEl.textContent = message;
      statusEl.className = `status ${isSuccess ? 'ok' : 'bad'}`;
      statusEl.style.display = 'block';

      setTimeout(() => {
        statusEl.style.display = 'none';
      }, 5000);
    }

    // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
    form.addEventListener("submit", function (e) {
      showStatus("‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•... ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà");

      // ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
      setTimeout(() => {
        try {
          const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
          const content = iframeDoc.body.textContent || iframeDoc.body.innerText;

          if (content) {
            try {
              const result = JSON.parse(content);
              if (result.success) {
                showStatus(`‚úÖ ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏á‡∏≤‡∏ô: ${result.ticketNo}`, true);
                form.reset();
              } else {
                showStatus(`‚ùå ${result.message}`);
              }
            } catch (e) {
              // ‡∏´‡∏≤‡∏Å response ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà JSON ‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
              if (content.includes("success") || content.length > 0) {
                showStatus("‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß", true);
                form.reset();
              } else {
                showStatus("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏");
              }
            }
          } else {
            showStatus("‚ùå ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå");
          }
        } catch (e) {
          showStatus("‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô", true);
          form.reset();
        }
      }, 1000); // ‡∏£‡∏≠ 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    });

    // ‡∏•‡πâ‡∏≤‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°
    form.addEventListener("reset", () => {
      statusEl.style.display = 'none';
    });

    // image 
  </script>
</body>

</html>